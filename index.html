<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KalÄ±n BaÄŸÄ±rsak Master - AYT Biyoloji</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap');
        body { font-family: 'Poppins', sans-serif; background-color: #f0f2f5; overflow-x: hidden; }
        .glass { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); border-radius: 20px; box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.15); }
        .btn-hover { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        .btn-hover:hover { transform: translateY(-3px); box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
        .matching-item { cursor: pointer; transition: all 0.2s; user-select: none; }
        .selected-item { border: 3px solid #3b82f6 !important; background-color: #eff6ff !important; transform: scale(1.02); }
        .correct-match { background-color: #dcfce7 !important; border-color: #22c55e !important; pointer-events: none; opacity: 0.8; }
        .badge-animation { animation: bounce 2s infinite; }
        @keyframes bounce { 0%, 20%, 50%, 80%, 100% {transform: translateY(0);} 40% {transform: translateY(-20px);} 60% {transform: translateY(-10px);} }
        
        /* Custom Modal Style */
        #custom-modal { z-index: 1000; }
        .modal-content { animation: slideIn 0.3s ease-out; }
        @keyframes slideIn { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }
    </style>
</head>
<body class="min-h-screen flex flex-col p-4 md:p-8">

    <!-- Ã–zel Modal (Alert/Confirm Yerine) -->
    <div id="custom-modal" class="hidden fixed inset-0 bg-black/50 flex items-center justify-center p-4">
        <div class="modal-content glass max-w-sm w-full p-6 text-center">
            <div id="modal-icon" class="text-4xl mb-4">âš ï¸</div>
            <h3 id="modal-title" class="text-xl font-bold mb-2">Emin misiniz?</h3>
            <p id="modal-text" class="text-gray-600 mb-6 text-sm">SÄ±navÄ± bÄ±rakÄ±rsanÄ±z ilerlemeniz kaybolacaktÄ±r.</p>
            <div class="flex gap-3 justify-center">
                <button id="modal-cancel" class="px-6 py-2 bg-gray-200 rounded-lg font-medium">VazgeÃ§</button>
                <button id="modal-confirm" class="px-6 py-2 bg-red-600 text-white rounded-lg font-medium">Evet, BÄ±rak</button>
            </div>
        </div>
    </div>

    <div id="app" class="max-w-4xl mx-auto w-full flex-grow">
        <!-- Header -->
        <header class="text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-bold text-blue-900 mb-2">KalÄ±n BaÄŸÄ±rsak Anatomisi ve Fizyolojisi</h1>
            <p class="text-gray-500 font-medium">2024 MEB MÃ¼fredatÄ± | AYT KazanÄ±m OdaklÄ±</p>
        </header>

        <!-- BÃ¶lÃ¼m 1: GiriÅŸ -->
        <div id="intro-screen" class="glass p-8 text-center border-b-8 border-blue-600">
            <div class="mb-6 flex justify-center">
                <div class="w-20 h-20 bg-blue-100 rounded-full flex items-center justify-center text-4xl shadow-inner">ğŸ©º</div>
            </div>
            <h2 class="text-2xl font-bold mb-4 text-gray-800">HazÄ±r mÄ±sÄ±n Åampiyon?</h2>
            <div class="text-left space-y-4 mb-8 text-gray-700 bg-white/50 p-6 rounded-2xl">
                <p>Bu uygulama <b>KalÄ±n BaÄŸÄ±rsak</b> fizyolojisini kalÄ±cÄ± Ã¶ÄŸrenmen iÃ§in tasarlandÄ±. SÄ±nav iÃ§eriÄŸi:</p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-3 text-sm font-medium">
                    <div class="flex items-center gap-2"><span class="w-2 h-2 bg-blue-500 rounded-full"></span> 5 Klasik Ã‡oktan SeÃ§meli</div>
                    <div class="flex items-center gap-2"><span class="w-2 h-2 bg-purple-500 rounded-full"></span> 5 Analitik Ã‡oklu SeÃ§im</div>
                    <div class="flex items-center gap-2"><span class="w-2 h-2 bg-green-500 rounded-full"></span> 5 DoÄŸru / YanlÄ±ÅŸ</div>
                    <div class="flex items-center gap-2"><span class="w-2 h-2 bg-orange-500 rounded-full"></span> 5 GÃ¶rsel EÅŸleÅŸtirme</div>
                    <div class="flex items-center gap-2"><span class="w-2 h-2 bg-red-500 rounded-full"></span> 5 SÃ¼reÃ§ SÄ±ralama</div>
                </div>
            </div>
            <button onclick="startQuiz()" class="bg-blue-600 text-white px-12 py-4 rounded-2xl font-bold text-xl btn-hover w-full shadow-lg shadow-blue-200">
                DENEMEYÄ° BAÅLAT ğŸš€
            </button>
        </div>

        <!-- BÃ¶lÃ¼m 2: SÄ±nav AlanÄ± -->
        <div id="quiz-screen" class="hidden glass p-6 md:p-10 relative">
            <div class="flex justify-between items-center mb-8">
                <div id="question-counter" class="bg-blue-600 text-white px-5 py-2 rounded-xl font-bold text-sm shadow-md">Soru: 1 / 25</div>
                <button onclick="askQuit()" class="bg-red-50 text-red-600 px-4 py-2 rounded-xl font-bold text-xs hover:bg-red-100 transition-colors uppercase tracking-wider border border-red-100">SÄ±navÄ± BÄ±rak</button>
            </div>

            <div id="question-container" class="min-h-[350px]">
                <!-- Sorular Dinamik Olarak Buraya Gelecek -->
            </div>

            <div id="feedback-area" class="hidden mt-8 p-6 rounded-2xl text-center shadow-sm">
                <!-- Bildirimler -->
            </div>

            <div class="mt-8 flex justify-between items-center border-t pt-6 border-gray-100">
                <p class="text-xs text-gray-400 italic">Cevaplamak iÃ§in seÃ§eneklere dokun!</p>
                <div class="flex gap-4">
                    <button id="check-btn" onclick="checkAnswer()" class="bg-indigo-600 text-white px-10 py-3 rounded-xl font-bold btn-hover shadow-lg shadow-indigo-100">CevabÄ± Onayla</button>
                    <button id="next-btn" onclick="nextQuestion()" class="hidden bg-gray-900 text-white px-10 py-3 rounded-xl font-bold btn-hover">SÄ±radaki Soru â”</button>
                </div>
            </div>
        </div>

        <!-- BÃ¶lÃ¼m 3: SonuÃ§ Raporu -->
        <div id="result-screen" class="hidden glass p-8 text-center border-t-8 border-green-500">
            <h2 class="text-3xl font-black mb-2 text-gray-800">KARNEN HAZIR!</h2>
            <p class="text-gray-500 mb-8 font-medium">PerformansÄ±nÄ± aÅŸaÄŸÄ±dan inceleyebilirsin</p>
            
            <div id="badge-container" class="mb-10 badge-animation flex flex-col items-center">
                <div class="text-8xl mb-2">ğŸ†</div>
                <div id="badge-text" class="bg-yellow-400 text-yellow-900 px-6 py-1 rounded-full font-black text-xs uppercase">Biyoloji ProfesÃ¶rÃ¼</div>
            </div>

            <div class="grid grid-cols-2 md:grid-cols-4 gap-6 mb-10">
                <div class="bg-white p-5 rounded-2xl shadow-sm border border-gray-100">
                    <p class="text-xs font-bold text-gray-400 uppercase mb-1">Toplam</p>
                    <p class="text-3xl font-black text-gray-800">25</p>
                </div>
                <div class="bg-green-50 p-5 rounded-2xl shadow-sm border border-green-100">
                    <p class="text-xs font-bold text-green-400 uppercase mb-1">DoÄŸru</p>
                    <p id="res-correct" class="text-3xl font-black text-green-600">0</p>
                </div>
                <div class="bg-red-50 p-5 rounded-2xl shadow-sm border border-red-100">
                    <p class="text-xs font-bold text-red-400 uppercase mb-1">YanlÄ±ÅŸ</p>
                    <p id="res-wrong" class="text-3xl font-black text-red-600">0</p>
                </div>
                <div class="bg-blue-50 p-5 rounded-2xl shadow-sm border border-blue-100">
                    <p class="text-xs font-bold text-blue-400 uppercase mb-1">BaÅŸarÄ±</p>
                    <p id="res-percent" class="text-3xl font-black text-blue-600">%0</p>
                </div>
            </div>

            <button onclick="location.reload()" class="bg-gray-800 text-white px-12 py-4 rounded-2xl font-bold text-lg btn-hover w-full md:w-auto">
                YENÄ°DEN BAÅLA ğŸ”„
            </button>
            <p class="text-gray-400 text-[10px] mt-8 uppercase tracking-widest font-bold">PaylaÅŸ ve ArkadaÅŸlarÄ±na Meydan Oku!</p>
        </div>
    </div>

    <!-- Footer TasarÄ±m Ä°mzasÄ± -->
    <footer class="mt-8 text-center py-6">
        <p class="text-gray-400 font-bold tracking-[0.3em] text-[10px] uppercase opacity-60">TasarÄ±m: Naci Karhan - 2026- Her HakkÄ± SaklÄ±dÄ±r</p>
    </footer>

    <script>
        // Soru BankasÄ±
        const questionBank = [
            // Klasik MC
            { type: 'mc', q: "KalÄ±n baÄŸÄ±rsak ile ince baÄŸÄ±rsaÄŸÄ± birbirine baÄŸlayan ilk bÃ¶lÃ¼me ne ad verilir?", options: ["Rektum", "AnÃ¼s", "Ã‡ekum", "Yatay Kolon", "Duodenum"], correct: 2, explanation: "Ä°nce baÄŸÄ±rsaÄŸÄ±n kalÄ±n baÄŸÄ±rsakla birleÅŸtiÄŸi Ã§Ä±kmaz uÃ§lu ilk bÃ¶lÃ¼me Ã‡ekum (KÃ¶r BaÄŸÄ±rsak) denir." },
            { type: 'mc', q: "KalÄ±n baÄŸÄ±rsakta emilimi en yoÄŸun ÅŸekilde gerÃ§ekleÅŸen temel madde hangisidir?", options: ["Glikoz", "Su ve Mineraller", "YaÄŸ Asitleri", "Amino Asitler", "Proteinler"], correct: 1, explanation: "KalÄ±n baÄŸÄ±rsaÄŸÄ±n ana gÃ¶revi su ve elektrolitlerin (minerallerin) geri emilimidir. Besin monomerleri ince baÄŸÄ±rsakta emilir." },
            { type: 'mc', q: "Apandisitin iltihaplanmasÄ± sonucu ortaya Ã§Ä±kan klinik durum hangisidir?", options: ["Ãœlser", "Kolit", "Apandisit", "Gastrit", "Hemoroid"], correct: 2, explanation: "Ã‡ekumun ucundaki apandis denilen lenfoid doku parÃ§asÄ±nÄ±n iltihabÄ±na apandisit denir." },
            { type: 'mc', q: "KalÄ±n baÄŸÄ±rsakta mutualist yaÅŸayan bakteriler hangi vitaminleri sentezler?", options: ["A ve D", "B ve K", "C ve E", "B12 ve D", "Sadece B"], correct: 1, explanation: "BaÄŸÄ±rsak florasÄ± B ve K vitaminlerini sentezleyerek insan metabolizmasÄ±na katkÄ±da bulunur." },
            { type: 'mc', q: "AÅŸaÄŸÄ±daki anatomik kÄ±sÄ±mlardan hangisi kalÄ±n baÄŸÄ±rsaÄŸa ait deÄŸildir?", options: ["Kolon", "Rektum", "Ã‡ekum", "Vilus", "Apandis"], correct: 3, explanation: "Viluslar emilim yÃ¼zeyini artÄ±rmak iÃ§in sadece ince baÄŸÄ±rsakta bulunur. KalÄ±n baÄŸÄ±rsak iÃ§ yÃ¼zeyi nispeten dÃ¼zdÃ¼r." },
            // Ã‡oklu SeÃ§im
            { type: 'multi', q: "KalÄ±n baÄŸÄ±rsaÄŸÄ±n temel fonksiyonlarÄ± nelerdir?", options: ["Su ve mineral emilimi", "K vitamini sentezi desteÄŸi", "Besinlerin kimyasal sindirimi", "AtÄ±klarÄ±n geÃ§ici depolanmasÄ±"], correct: [0, 1, 3], explanation: "KalÄ±n baÄŸÄ±rsakta kimyasal sindirim gerÃ§ekleÅŸmez; sindirim enzimi Ã¼retilmez." },
            { type: 'multi', q: "Hangi durumlar kalÄ±n baÄŸÄ±rsak florasÄ±nÄ± olumsuz etkileyebilir?", options: ["BilinÃ§siz antibiyotik kullanÄ±mÄ±", "YÃ¼ksek lifli gÄ±dalarla beslenme", "BaÄŸÄ±rsak enfeksiyonlarÄ±", "Probiyotik kullanÄ±mÄ±"], correct: [0, 2], explanation: "Antibiyotikler yararlÄ± bakterileri Ã¶ldÃ¼rÃ¼r. Lifli gÄ±dalar ve probiyotikler ise florayÄ± korur." },
            { type: 'multi', q: "KalÄ±n baÄŸÄ±rsak kolon bÃ¶lÃ¼mleri hangileridir?", options: ["Ã‡Ä±kan kolon", "Yatay kolon", "Ä°nen kolon", "Pilorik kolon"], correct: [0, 1, 2], explanation: "KalÄ±n baÄŸÄ±rsak Ã§Ä±kan, yatay, inen ve S ÅŸekilli (Sigmoid) kolon bÃ¶lÃ¼mlerinden oluÅŸur." },
            { type: 'multi', q: "Rektum ve anÃ¼s ile ilgili hangileri doÄŸrudur?", options: ["DÄ±ÅŸkÄ± geÃ§ici olarak rektumda depolanÄ±r", "AnÃ¼s tek bir dÃ¼z kas sfinkterinden oluÅŸur", "DÄ±ÅŸkÄ±lama refleksi otonom ve iradi kontrol altÄ±ndadÄ±r", "Burada aktif besin emilimi yapÄ±lÄ±r"], correct: [0, 2], explanation: "AnÃ¼ste hem Ã§izgili hem dÃ¼z kas vardÄ±r. Besin emilimi burada yapÄ±lmaz." },
            { type: 'multi', q: "BaÄŸÄ±rsak saÄŸlÄ±ÄŸÄ± iÃ§in hangileri Ã¶nemlidir?", options: ["Bol su tÃ¼ketimi", "Hareketsiz yaÅŸam", "Lifli besinler", "Ã–ÄŸÃ¼n atlamak"], correct: [0, 2], explanation: "Su ve lif, dÄ±ÅŸkÄ±nÄ±n ilerlemesini ve kabÄ±zlÄ±ÄŸÄ±n Ã¶nlenmesini saÄŸlar." },
            // D/Y
            { type: 'tf', q: "KalÄ±n baÄŸÄ±rsakta kimyasal sindirimi saÄŸlayan enzimler salgÄ±lanÄ±r.", correct: false, explanation: "HatalÄ±! KalÄ±n baÄŸÄ±rsakta sindirim enzimi salgÄ±lanmaz, sadece mukus salgÄ±lanÄ±r." },
            { type: 'tf', q: "Su emilimi azaldÄ±ÄŸÄ±nda dÄ±ÅŸkÄ± sÄ±vÄ±laÅŸÄ±r ve ishal (diyare) meydana gelir.", correct: true, explanation: "DoÄŸru! Su emilemediÄŸinde dÄ±ÅŸkÄ±daki sÄ±vÄ± miktarÄ± artar." },
            { type: 'tf', q: "KalÄ±n baÄŸÄ±rsaÄŸÄ±n boyu ortalama 1.5 metredir.", correct: true, explanation: "DoÄŸru! Anatomik olarak ince baÄŸÄ±rsaktan daha kÄ±sa ama Ã§apÄ± daha geniÅŸtir." },
            { type: 'tf', q: "BaÄŸÄ±rsaktaki B ve K vitaminlerinin emilimi kalÄ±n baÄŸÄ±rsakta yapÄ±lÄ±r.", correct: true, explanation: "DoÄŸru! Bakterilerce sentezlenen bu vitaminler buradan emilir." },
            { type: 'tf', q: "Viluslar kalÄ±n baÄŸÄ±rsakta yÃ¼zey alanÄ±nÄ± 30 kat artÄ±rÄ±r.", correct: false, explanation: "HatalÄ±! KalÄ±n baÄŸÄ±rsakta vilus bulunmaz, o ince baÄŸÄ±rsaÄŸa has bir Ã¶zelliktir." },
            // EÅŸleÅŸtirme
            { type: 'match', q: "KavramlarÄ± doÄŸru aÃ§Ä±klamalarÄ±yla eÅŸleÅŸtiriniz.", pairs: [
                { left: "Kolit", right: "BaÄŸÄ±rsak iltihabÄ±" },
                { left: "Hemoroid", right: "Rektal damar geniÅŸlemesi" },
                { left: "Diyare", right: "AÅŸÄ±rÄ± sulu dÄ±ÅŸkÄ±" },
                { left: "Konstipasyon", right: "KabÄ±zlÄ±k durumu" },
                { left: "Sfinkter", right: "KasÄ±lan bÃ¼zgen kas" }
            ]},
            { type: 'match', q: "SalgÄ±-Organ eÅŸleÅŸtirmesi yapÄ±nÄ±z.", pairs: [
                { left: "Safra", right: "KaraciÄŸer" },
                { left: "Pepsinojen", right: "Mide" },
                { left: "Enterokinaz", right: "Ä°nce BaÄŸÄ±rsak" },
                { left: "Ä°nsÃ¼lin", right: "Pankreas" },
                { left: "Mukus", right: "KalÄ±n BaÄŸÄ±rsak" }
            ]},
            { type: 'match', q: "Anatomik bÃ¶lgeleri tanÄ±mlayÄ±n.", pairs: [
                { left: "Ã‡ekum", right: "KÃ¶r uÃ§lu baÅŸlangÄ±Ã§" },
                { left: "AnÃ¼s", right: "BoÅŸaltÄ±m deliÄŸi" },
                { left: "Kolon", right: "GeniÅŸ orta segment" },
                { left: "Rektum", right: "DÃ¼zleÅŸen son kÄ±sÄ±m" },
                { left: "Valf", right: "Geri dÃ¶nÃ¼ÅŸÃ¼ Ã¶nleyen kapak" }
            ]},
            { type: 'match', q: "MolekÃ¼l-Emilim eÅŸleÅŸtirmesi yapÄ±nÄ±z.", pairs: [
                { left: "Su", right: "Pasif taÅŸÄ±ma / Osmoz" },
                { left: "Sodyum", right: "Aktif taÅŸÄ±ma" },
                { left: "B Vitamini", right: "Bakteriyel kaynaklÄ± emilim" },
                { left: "SelÃ¼loz", right: "AtÄ±k olarak kalÄ±r" },
                { left: "Ä°laÃ§lar", right: "BazÄ± mukoza emilimleri" }
            ]},
            { type: 'match', q: "Enzim-Besin eÅŸleÅŸtirmesi yapÄ±nÄ±z (Genel Bilgi).", pairs: [
                { left: "Amilaz", right: "NiÅŸasta" },
                { left: "Lipaz", right: "YaÄŸ" },
                { left: "Tripsin", right: "Protein" },
                { left: "NÃ¼kleaz", right: "NÃ¼kleik Asit" },
                { left: "Laktaz", right: "SÃ¼t Åekeri" }
            ]},
            // SÄ±ralama
            { type: 'order', q: "Sindirim atÄ±ÄŸÄ±nÄ±n izlediÄŸi yolu baÅŸtan sona sÄ±ralayÄ±nÄ±z.", items: ["Ä°nce BaÄŸÄ±rsak Sonu", "KÃ¶r BaÄŸÄ±rsak", "Yatay Kolon", "Ä°nen Kolon", "DÃ¼z BaÄŸÄ±rsak (Rektum)"], correctOrder: [0, 1, 2, 3, 4] },
            { type: 'order', q: "Anatomik kolon bÃ¶lÃ¼mlerini yukarÄ±dan aÅŸaÄŸÄ±ya (akÄ±ÅŸ yÃ¶nÃ¼ne gÃ¶re) dizin.", items: ["Ä°leum (Ä°nce B.)", "Ã‡Ä±kan Kolon", "Yatay Kolon", "Ä°nen Kolon", "Sigmoid Kolon"], correctOrder: [0, 1, 2, 3, 4] },
            { type: 'order', q: "DÄ±ÅŸkÄ±lama mekanizmasÄ±nÄ± sÄ±ralayÄ±n.", items: ["AtÄ±klarÄ±n rektuma girmesi", "ReseptÃ¶rlerin gerilmesi", "Sinyalin beyne gitmesi", "Ä°Ã§ kasÄ±n gevÅŸemesi", "Ä°steÄŸe baÄŸlÄ± dÄ±ÅŸkÄ±lama"], correctOrder: [0, 1, 2, 3, 4] },
            { type: 'order', q: "Bir suyun vÃ¼cuttan atÄ±lana kadar geÃ§tiÄŸi sindirim kanallarÄ±nÄ± dizin.", items: ["Ã–zofagus", "Mide", "Pilor", "Ä°nce BaÄŸÄ±rsak", "KalÄ±n BaÄŸÄ±rsak"], correctOrder: [0, 1, 2, 3, 4] },
            { type: 'order', q: "Sindirimin bÃ¶lÃ¼mlerini baÅŸtan sona dizin.", items: ["Mekanik Sindirim", "Kimyasal Sindirim", "Emilim", "Geri Emilim", "Defekasyon (DÄ±ÅŸkÄ±lama)"], correctOrder: [0, 1, 2, 3, 4] }
        ];

        let currentQuestionIndex = 0;
        let score = { correct: 0, wrong: 0 };
        let quizQuestions = [];
        let selectedMatchLeft = null;
        let matchesFound = 0;

        // GerÃ§ek Rastgele KarÄ±ÅŸtÄ±rma (Fisher-Yates)
        function shuffle(array) {
            let currentIndex = array.length, randomIndex;
            while (currentIndex != 0) {
                randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex--;
                [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
            }
            return array;
        }

        // Custom Modal Logic
        function showModal(title, text, confirmCallback, icon = "âš ï¸") {
            const modal = document.getElementById('custom-modal');
            document.getElementById('modal-title').innerText = title;
            document.getElementById('modal-text').innerText = text;
            document.getElementById('modal-icon').innerText = icon;
            modal.classList.remove('hidden');

            const confirmBtn = document.getElementById('modal-confirm');
            const cancelBtn = document.getElementById('modal-cancel');

            const cleanup = () => {
                modal.classList.add('hidden');
                confirmBtn.onclick = null;
                cancelBtn.onclick = null;
            };

            confirmBtn.onclick = () => { confirmCallback(); cleanup(); };
            cancelBtn.onclick = cleanup;
        }

        function askQuit() {
            showModal("SÄ±navÄ± BÄ±rak?", "HenÃ¼z sÄ±navÄ± bitirmedin. Ã‡Ä±kmak istediÄŸine emin misin?", () => {
                location.reload();
            });
        }

        function startQuiz() {
            document.getElementById('intro-screen').classList.add('hidden');
            document.getElementById('quiz-screen').classList.remove('hidden');
            quizQuestions = shuffle([...questionBank]);
            showQuestion();
        }

        function showQuestion() {
            const qData = quizQuestions[currentQuestionIndex];
            const container = document.getElementById('question-container');
            const feedback = document.getElementById('feedback-area');
            const checkBtn = document.getElementById('check-btn');
            const nextBtn = document.getElementById('next-btn');
            
            feedback.classList.add('hidden');
            nextBtn.classList.add('hidden');
            checkBtn.classList.remove('hidden');
            document.getElementById('question-counter').innerText = `Soru: ${currentQuestionIndex + 1} / 25`;
            
            container.innerHTML = `<h3 class="text-xl font-bold text-gray-800 mb-6 leading-relaxed">${qData.q}</h3>`;

            if (qData.type === 'mc') {
                const optDiv = document.createElement('div');
                optDiv.className = 'space-y-3';
                qData.options.forEach((opt, i) => {
                    optDiv.innerHTML += `<div onclick="selectRadio(this)" class="p-4 border-2 border-gray-100 rounded-2xl cursor-pointer hover:bg-blue-50 transition-all flex items-center gap-3 font-medium text-gray-700">
                        <input type="radio" name="ans" value="${i}" class="w-5 h-5"> <span>${opt}</span>
                    </div>`;
                });
                container.appendChild(optDiv);
            } else if (qData.type === 'multi') {
                const optDiv = document.createElement('div');
                optDiv.className = 'space-y-3';
                qData.options.forEach((opt, i) => {
                    optDiv.innerHTML += `<div onclick="selectCheck(this)" class="p-4 border-2 border-gray-100 rounded-2xl cursor-pointer hover:bg-purple-50 transition-all flex items-center gap-3 font-medium text-gray-700">
                        <input type="checkbox" name="ans" value="${i}" class="w-5 h-5"> <span>${opt}</span>
                    </div>`;
                });
                container.appendChild(optDiv);
            } else if (qData.type === 'tf') {
                container.innerHTML += `<div class="grid grid-cols-2 gap-4 pt-4">
                    <button onclick="checkTF(true)" class="py-8 rounded-3xl bg-green-50 border-2 border-green-200 text-green-700 font-black text-2xl hover:bg-green-100 transition-all">DOÄRU</button>
                    <button onclick="checkTF(false)" class="py-8 rounded-3xl bg-red-50 border-2 border-red-200 text-red-700 font-black text-2xl hover:bg-red-100 transition-all">YANLIÅ</button>
                </div>`;
                checkBtn.classList.add('hidden');
            } else if (qData.type === 'match') {
                matchesFound = 0;
                selectedMatchLeft = null;
                const grid = document.createElement('div');
                grid.className = 'grid grid-cols-2 gap-4';
                
                const lefts = shuffle(qData.pairs.map((p, i) => ({ t: p.left, id: i })));
                const rights = shuffle(qData.pairs.map((p, i) => ({ t: p.right, id: i })));

                let lCol = '<div class="space-y-2">';
                lefts.forEach(item => lCol += `<div id="l-${item.id}" onclick="matchClick('l', ${item.id})" class="matching-item p-3 bg-white border-2 border-gray-200 rounded-xl text-xs font-bold shadow-sm">${item.t}</div>`);
                lCol += '</div>';

                let rCol = '<div class="space-y-2">';
                rights.forEach(item => rCol += `<div id="r-${item.id}" onclick="matchClick('r', ${item.id})" class="matching-item p-3 bg-white border-2 border-gray-200 rounded-xl text-xs font-bold shadow-sm">${item.t}</div>`);
                rCol += '</div>';

                grid.innerHTML = lCol + rCol;
                container.appendChild(grid);
                checkBtn.classList.add('hidden');
            } else if (qData.type === 'order') {
                const list = document.createElement('div');
                list.id = "order-list";
                list.className = 'space-y-2';
                let items = shuffle(qData.items.map((t, i) => ({ t, id: i })));
                items.forEach(item => {
                    list.innerHTML += `<div data-id="${item.id}" class="flex items-center justify-between p-4 bg-white border-2 border-gray-100 rounded-xl shadow-sm">
                        <span class="font-bold text-gray-700">${item.t}</span>
                        <div class="flex gap-1">
                            <button onclick="move(this, -1)" class="w-8 h-8 bg-gray-100 rounded-lg font-bold">â†‘</button>
                            <button onclick="move(this, 1)" class="w-8 h-8 bg-gray-100 rounded-lg font-bold">â†“</button>
                        </div>
                    </div>`;
                });
                container.appendChild(list);
            }
        }

        // Selection Helpers
        function selectRadio(el) { el.querySelector('input').checked = true; }
        function selectCheck(el) { el.querySelector('input').checked = !el.querySelector('input').checked; }
        function move(btn, dir) {
            const item = btn.closest('[data-id]');
            if (dir === -1 && item.previousElementSibling) item.parentNode.insertBefore(item, item.previousElementSibling);
            else if (dir === 1 && item.nextElementSibling) item.parentNode.insertBefore(item.nextElementSibling, item);
        }

        function matchClick(side, id) {
            const el = document.getElementById(`${side}-${id}`);
            if (el.classList.contains('correct-match')) return;

            if (side === 'l') {
                if (selectedMatchLeft !== null) document.getElementById(`l-${selectedMatchLeft}`).classList.remove('selected-item');
                selectedMatchLeft = id;
                el.classList.add('selected-item');
            } else {
                if (selectedMatchLeft !== null) {
                    if (selectedMatchLeft === id) {
                        el.classList.add('correct-match');
                        document.getElementById(`l-${id}`).classList.add('correct-match');
                        matchesFound++;
                        selectedMatchLeft = null;
                        if (matchesFound === quizQuestions[currentQuestionIndex].pairs.length) showFeedback(true);
                    } else {
                        el.classList.add('bg-red-50', 'border-red-300');
                        setTimeout(() => el.classList.remove('bg-red-50', 'border-red-300'), 400);
                    }
                }
            }
        }

        function checkTF(val) { showFeedback(val === quizQuestions[currentQuestionIndex].correct); }

        function checkAnswer() {
            const q = quizQuestions[currentQuestionIndex];
            let correct = false;
            if (q.type === 'mc') {
                const sel = document.querySelector('input[name="ans"]:checked');
                if (!sel) return;
                correct = parseInt(sel.value) === q.correct;
            } else if (q.type === 'multi') {
                const sels = Array.from(document.querySelectorAll('input[name="ans"]:checked')).map(i => parseInt(i.value));
                if (sels.length === 0) return;
                correct = JSON.stringify(sels.sort()) === JSON.stringify(q.correct.sort());
            } else if (q.type === 'order') {
                const order = Array.from(document.querySelectorAll('#order-list > div')).map(d => parseInt(d.dataset.id));
                correct = JSON.stringify(order) === JSON.stringify(q.correctOrder);
            }
            showFeedback(correct);
        }

        function showFeedback(isCorrect) {
            const fb = document.getElementById('feedback-area');
            const q = quizQuestions[currentQuestionIndex];
            fb.classList.remove('hidden');
            document.getElementById('check-btn').classList.add('hidden');
            document.getElementById('next-btn').classList.remove('hidden');

            if (isCorrect) {
                score.correct++;
                fb.innerHTML = `<p class="text-green-600 font-black text-xl mb-1">ğŸ”” TEBRÄ°KLER! (DoÄŸru Cevap Sesi)</p>
                                <p class="text-green-700/70 text-sm">Bilgi daÄŸarcÄ±ÄŸÄ±na bir tuÄŸla daha ekledin!</p>`;
                fb.className = "mt-8 p-6 rounded-2xl text-center bg-green-50 border-2 border-green-200";
            } else {
                score.wrong++;
                fb.innerHTML = `<p class="text-red-600 font-black text-xl mb-2">âŒ DÄ°KKAT! (YanlÄ±ÅŸ Cevap Sesi)</p>
                                <div class="bg-white/60 p-3 rounded-xl text-left border border-red-100">
                                    <p class="text-gray-800 text-xs font-bold uppercase mb-1">Neden YanlÄ±ÅŸ?</p>
                                    <p class="text-gray-600 text-sm leading-relaxed">${q.explanation || "Konuyu tekrar etmelisin."}</p>
                                </div>`;
                fb.className = "mt-8 p-6 rounded-2xl text-center bg-red-50 border-2 border-red-200";
            }
        }

        function nextQuestion() {
            currentQuestionIndex++;
            if (currentQuestionIndex < quizQuestions.length) showQuestion();
            else showResults();
        }

        function showResults() {
            document.getElementById('quiz-screen').classList.add('hidden');
            document.getElementById('result-screen').classList.remove('hidden');
            const p = Math.round((score.correct / 25) * 100);
            document.getElementById('res-correct').innerText = score.correct;
            document.getElementById('res-wrong').innerText = score.wrong;
            document.getElementById('res-percent').innerText = `%${p}`;
            
            const b = document.getElementById('badge-container');
            const bt = document.getElementById('badge-text');
            if (p >= 90) { b.querySelector('.text-8xl').innerText = "ğŸ”¬"; bt.innerText = "Biyoloji ProfesÃ¶rÃ¼"; }
            else if (p >= 70) { b.querySelector('.text-8xl').innerText = "ğŸ“–"; bt.innerText = "Uzman AraÅŸtÄ±rmacÄ±"; }
            else if (p >= 50) { b.querySelector('.text-8xl').innerText = "ğŸŒ±"; bt.innerText = "GeliÅŸmekte Olan"; }
            else { b.querySelector('.text-8xl').innerText = "ğŸ”‹"; bt.innerText = "Daha Ã‡ok Ã‡alÄ±ÅŸmalÄ±"; }
        }
    </script>
</body>
</html>